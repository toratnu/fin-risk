# 投資リスク許容度診断アプリ 質問仕様書

## 1. 概要

本ドキュメントは、投資リスク許容度診断アプリケーションの質問、回答、および診断ロジックを定義する`public/questions.json`ファイルの仕様を記述したものです。

## 2. ファイル構造

`questions.json`は、単一のJSONオブジェクトで構成されています。このオブジェクトには2つの主要なキーが含まれます。

- `initialQuestionId` (string): ユーザーに最初に提示される質問のID。
- `questions` (object): アプリケーションで利用可能なすべての質問を格納するオブジェクト。各キーはユニークな質問IDです。

```json
{
  "initialQuestionId": "q1",
  "questions": {
    "q1": { ... },
    "q2": { ... },
    ...
  }
}
```

## 3. データ詳細

### 3.1. 質問オブジェクト (`questions.<questionId>`)

`questions`オブジェクト内の各質問は、以下のキーを持ちます。

- `text` (string): ユーザーに表示される質問文。
- `options` (array): ユーザーが選択できる回答の選択肢を格納した配列。

```json
"q1": {
  "text": "年齢について教えてください。",
  "options": [ ... ]
}
```

### 3.2. 選択肢オブジェクト (`options`配列の要素)

各選択肢は、以下のキーを持つオブジェクトです。

- `text` (string): 選択肢として表示されるテキスト。
- `score` (number): 診断タイプを決定するための基本的なスコア（現在は診断ロジックで直接使用されていないが、将来の拡張のために保持）。
- `radarScore` (object): 最終結果ページのレーダーチャートに反映されるスコア。キーが評価軸、値がその軸に加算される点数となります。
  - **評価軸**: `積極性`, `安定性`, `収益性`, `経験値`, `金融リテラシー`, `合理性`
- `nextQuestionId` (string | null): この選択肢が選ばれた場合に、次に表示される質問のID。`null`が指定されている場合、それが最後の質問であることを示します。

```json
{
  "text": "20代",
  "score": 5,
  "radarScore": { "積極性": 5, "経験値": 1 },
  "nextQuestionId": "q2"
}
```

## 4. 質問フローと条件分岐

- アプリケーションは`initialQuestionId`に指定された質問から開始されます。
- ユーザーが選択肢を選ぶと、その選択肢の`nextQuestionId`を元に次の質問が表示されます。
- この仕組みにより、ユーザーの回答に基づいた動的な質問遷移（条件分岐）が実現されています。

**具体例:**

質問`q2`（投資経験）では、
- 「未経験」と回答した場合 (`nextQuestionId: "q4"`)、投資額に関する質問`q3`をスキップして、損失許容度に関する質問`q4`に進みます。
- 「1-3年未満」などの経験者向けの回答をした場合 (`nextQuestionId: "q3"`)、次に投資額に関する質問`q3`が表示されます。

## 5. スコアリングと診断ロジック

- ユーザーがすべての質問に回答すると、各回答で得られた`radarScore`が評価軸ごとに合算されます。
- この合算されたスコアオブジェクトが、結果表示コンポーネント（`ResultPage.tsx`）の`getDiagnosis`関数に渡されます。
- `getDiagnosis`関数は、このスコアを元に以下の処理を行い、最終的な診断結果を決定します。
  1.  **基本タイプの判定**: 主に「積極性」「安定性」「収益性」のスコアを元に、5段階の基本投資家タイプを決定します。
  2.  **調整**: 「金融リテラシー」と「合理性」のスコアが低い場合、リスクの高い投資家タイプから、より安全なタイプへと診断結果を下方修正します。
  3.  **ポートフォリオ提案**: 最終的に決定された投資家タイプと、リテラシー/合理性のスコアに基づいて、具体的なポートフォリオを提案します。
